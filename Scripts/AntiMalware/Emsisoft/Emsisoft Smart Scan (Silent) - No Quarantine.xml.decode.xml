<LabTech_Expansion Version="100.332" Name="LabTech Script Expansion" Type="PackedScript">
  <PackedScript>
    <NewDataSet>
      <Table>
        <ScriptId>5795</ScriptId>
        <FolderId>149</FolderId>
        <ScriptName>Emsisoft Smart Scan (Silent) - No Quarantine</ScriptName>
        <ScriptNotes>a2cmd

Written by Mike McGhee</ScriptNotes>
        <Permission>2,4,</Permission>
        <EditPermission>1,</EditPermission>
        <ComputerScript>1</ComputerScript>
        <LocationScript>0</LocationScript>
        <MaintenanceScript>0</MaintenanceScript>
        <FunctionScript>0</FunctionScript>
        <LicenseData>
          <Type>1</Type>
          <RunCounter>0</RunCounter>
          <ExpireDate>Wednesday, April 24, 2013 7:39:39 PM</ExpireDate>
          <ScriptVersion>0</ScriptVersion>
          <ScriptGuid>6be9eb17-a2f8-11e3-bedc-00155d007008</ScriptGuid>
        </LicenseData>
<ScriptData>
  <Scripts>
    <ExtraDataFields />
    <Parameters />
    <Globals />
    <ScriptVersion>1</ScriptVersion>
    <ScriptGuid>6be9eb17-a2f8-11e3-bedc-00155d007008</ScriptGuid>
  </Scripts>
  <ScriptSteps>
    <Action>1</Action>
    <FunctionId>1</FunctionId>
    <Param1 />
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>0</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>31</FunctionId>
    <Param1>1</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>0</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>13</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\a2cmd_scan.log</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>1</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>114</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\a2cmd.exe</Param1>
    <Param2>0</Param2>
    <Param3>:Update</Param3>
    <Param4 />
    <Param5 />
    <Sort>2</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>19</FunctionId>
    <Param1>http://download5.emsisoft.com/a2cmd.zip</Param1>
    <Param2>%ltsvcdir%\a2cmd.zip</Param2>
    <Param3>0</Param3>
    <Param4 />
    <Param5 />
    <Sort>3</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:CheckUnzip</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>4</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>114</FunctionId>
    <Param1>%ltsvcdir%\unzip.exe</Param1>
    <Param2>0</Param2>
    <Param3>:Unzipa2cmd</Param3>
    <Param4 />
    <Param5 />
    <Sort>5</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>28</FunctionId>
    <Param1>Tools\UnZip.exe</Param1>
    <Param2>%ltsvcdir%\UnZip.exe</Param2>
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>6</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>114</FunctionId>
    <Param1>%ltsvcdir%\unzip.exe</Param1>
    <Param2>0</Param2>
    <Param3>:Unzipa2cmd</Param3>
    <Param4 />
    <Param5 />
    <Sort>7</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>29</FunctionId>
    <Param1>Unzip file tool failed to download. Make sure the Unzip.exe file exists in \ltshare\transfer\tools and is accessible then rerun the script. Exiting script</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>8</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>2</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:Unzipa2cmd</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>9</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>16</FunctionId>
    <Param1>%ltsvcdir%\Unzip.exe -o %ltsvcdir%\a2cmd.zip -d %ltsvcdir%\a2cmd</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>10</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>13</FunctionId>
    <Param1>%ltsvcdir%\a2cmd.zip</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>11</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>2</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:Update</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>12</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>80</FunctionId>
    <Param1>857b6f38-9ff5-11e3-bedc-00155d007008</Param1>
    <Param2>@computerid@</Param2>
    <Param3>1</Param3>
    <Param4 />
    <Param5 />
    <Sort>13</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>90</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\whitelist.txt</Param1>
    <Param2>%ltsvcdir%</Param2>
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>14</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>16</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\a2cmd.exe /u</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>15</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>16</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\a2cmd.exe /smart /m /t /c /a /pup /wl="%ltsvcdir%\a2cmd\whitelist.txt" /log="%ltsvcdir%\a2cmd\a2cmd_scan.log"</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>16</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>Wait for a2cmd to finish...</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>17</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>20</FunctionId>
    <Param1>1</Param1>
    <Param2>0</Param2>
    <Param3>cnt</Param3>
    <Param4 />
    <Param5 />
    <Sort>18</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:a2cmdCheck</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>19</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>114</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\a2cmd_scan.log</Param1>
    <Param2>0</Param2>
    <Param3>:a2cmdFinished</Param3>
    <Param4 />
    <Param5 />
    <Sort>20</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>2</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>70</FunctionId>
    <Param1>cnt</Param1>
    <Param2>6</Param2>
    <Param3>120</Param3>
    <Param4>:timeout</Param4>
    <Param5 />
    <Sort>21</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>3</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>21</FunctionId>
    <Param1>60</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>22</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>4</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>101</FunctionId>
    <Param1>@cnt@</Param1>
    <Param2>0</Param2>
    <Param3>1</Param3>
    <Param4>tmp</Param4>
    <Param5 />
    <Sort>23</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>3</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>20</FunctionId>
    <Param1>1</Param1>
    <Param2>%mathresult%</Param2>
    <Param3>cnt</Param3>
    <Param4 />
    <Param5 />
    <Sort>24</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>3</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>129</FunctionId>
    <Param1>:a2cmdCheck</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>25</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>4</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:timeout</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>26</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>29</FunctionId>
    <Param1>Something went wrong!</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>27</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>2</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>215</FunctionId>
    <Param1 />
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>28</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>3</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:a2cmdFinished</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>29</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>80</FunctionId>
    <Param1>2fcf0279-9fe8-11e3-bedc-00155d007008</Param1>
    <Param2>@computerid@</Param2>
    <Param3>1</Param3>
    <Param4 />
    <Param5 />
    <Sort>30</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>20</FunctionId>
    <Param1>7</Param1>
    <Param2>%ltsvcdir%\a2cmd\a2cmd_scan.log</Param2>
    <Param3>a2cmd_results</Param3>
    <Param4 />
    <Param5 />
    <Sort>31</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>90</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\results.html</Param1>
    <Param2>&lt;pre&gt;@a2cmd_results@&lt;/pre&gt;</Param2>
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>32</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>18</FunctionId>
    <Param1>%ltsvcdir%\a2cmd\results.html</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>33</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>20</FunctionId>
    <Param1>1</Param1>
    <Param2>1667</Param2>
    <Param3>computerid</Param3>
    <Param4 />
    <Param5 />
    <Sort>34</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>154</FunctionId>
    <Param1>C:\inetpub\wwwroot\LabTech\Reports\EMSISOFT</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>35</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>16</FunctionId>
    <Param1>del C:\inetpub\wwwroot\LabTech\Reports\EMSISOFT\%computername%(%computerid%)-emsisoftresults.html</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>36</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>34</FunctionId>
    <Param1>%uploadedfile%</Param1>
    <Param2>C:\inetpub\wwwroot\LabTech\Reports\EMSISOFT\%computername%(%computerid%)-emsisoftresults.html</Param2>
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>37</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>129</FunctionId>
    <Param1>0</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>38</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
</ScriptData>
<ScriptVersion>1</ScriptVersion><ScriptGuid>6be9eb17-a2f8-11e3-bedc-00155d007008</ScriptGuid><ScriptFlags>0</ScriptFlags><Parameters></Parameters></Table>
    </NewDataSet>
    <File Name="L:\Transfer\Tools\UnZip.exe" Bytes="This value has been replaced and the file extracted to the Transfer folder" />
    <ExtraDataField>
      <NewDataSet>
        <Table>
          <ID>912</ID>
          <Form>1</Form>
          <Name>Emsisoft Deployed</Name>
          <Sort>0</Sort>
          <NoBreak>0</NoBreak>
          <FType>1</FType>
          <Section>Emsisoft</Section>
          <UnEditable>0</UnEditable>
          <Collapsed>0</Collapsed>
          <Fill>
          </Fill>
          <LtGuid>857b6f38-9ff5-11e3-bedc-00155d007008</LtGuid>
          <IsPassword>false</IsPassword>
          <IsEncrypted>false</IsEncrypted>
          <IsHidden>false</IsHidden>
          <IsRestricted>false</IsRestricted>
        </Table>
      </NewDataSet>
    </ExtraDataField>
    <ExtraDataField>
      <NewDataSet>
        <Table>
          <ID>911</ID>
          <Form>1</Form>
          <Name>Commandline Scanner Used</Name>
          <Sort>0</Sort>
          <NoBreak>0</NoBreak>
          <FType>1</FType>
          <Section>Emsisoft</Section>
          <UnEditable>0</UnEditable>
          <Collapsed>0</Collapsed>
          <Fill>Licensing Purposes</Fill>
          <LtGuid>2fcf0279-9fe8-11e3-bedc-00155d007008</LtGuid>
          <IsPassword>false</IsPassword>
          <IsEncrypted>false</IsEncrypted>
          <IsHidden>false</IsHidden>
          <IsRestricted>false</IsRestricted>
        </Table>
      </NewDataSet>
    </ExtraDataField>
    <ScriptFolder>
      <NewDataSet>
        <Table>
          <FolderID>149</FolderID>
          <ParentID>9</ParentID>
          <Name>Emsisoft</Name>
          <GUID>089f6f54-4791-48eb-af34-ea513ee81381</GUID>
        </Table>
      </NewDataSet>
    </ScriptFolder>
    <ScriptFolder>
      <NewDataSet>
        <Table>
          <FolderID>9</FolderID>
          <ParentID>0</ParentID>
          <Name>Anti-Spyware</Name>
          <GUID>96dbd2e0-1a86-43ea-9785-8dc7f456aaed</GUID>
        </Table>
      </NewDataSet>
    </ScriptFolder>
  </PackedScript>
</LabTech_Expansion>