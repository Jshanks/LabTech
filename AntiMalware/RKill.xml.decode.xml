<LabTech_Expansion Version="100.332" Name="LabTech Script Expansion" Type="PackedScript">
  <PackedScript>
    <NewDataSet>
      <Table>
        <ScriptId>5362</ScriptId>
        <FolderId>124</FolderId>
        <ScriptName>RKill</ScriptName>
        <ScriptNotes>RKill is a program that was developed at BleepingComputer.com that attempts to terminate known malware processes so that your normal security software can then run and clean your computer of infections.

Edit whitelist in Step 4 to include ScreenConnect GUID

Written by Mike McGhee

Written by Mike McGhee</ScriptNotes>
        <Permission>2,4,</Permission>
        <EditPermission>1,</EditPermission>
        <ComputerScript>1</ComputerScript>
        <LocationScript>0</LocationScript>
        <MaintenanceScript>0</MaintenanceScript>
        <FunctionScript>0</FunctionScript>
        <LicenseData>
          <Type>1</Type>
          <RunCounter>0</RunCounter>
          <ExpireDate>Wednesday, April 24, 2013 7:39:39 PM</ExpireDate>
          <ScriptVersion>0</ScriptVersion>
          <ScriptGuid>e1d00ad8-ad17-11e2-b867-00155d007008</ScriptGuid>
        </LicenseData>
<ScriptData>
  <Scripts>
    <ExtraDataFields />
    <Parameters />
    <Globals />
    <ScriptVersion>1</ScriptVersion>
    <ScriptGuid>e1d00ad8-ad17-11e2-b867-00155d007008</ScriptGuid>
  </Scripts>
  <ScriptSteps>
    <Action>1</Action>
    <FunctionId>8</FunctionId>
    <Param1 />
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>0</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>31</FunctionId>
    <Param1>1</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>0</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>154</FunctionId>
    <Param1>%ltsvcdir%\MalwareRemoval</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>1</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>28</FunctionId>
    <Param1>Software\MalwareRemoval\explorer.exe</Param1>
    <Param2>%ltsvcdir%\MalwareRemoval\explorer.exe</Param2>
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>2</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>90</FunctionId>
    <Param1>%ltsvcdir%\MalwareRemoval\rkill_process_whitelist.txt</Param1>
    <Param2>%ProgramFiles(x86)%\TeamViewer\TeamViewer.exe
%ProgramFiles(x86)%\TeamViewer\TeamViewer_Desktop.exe
%ProgramFiles(x86)%\TeamViewer\TeamViewer_Service.exe
%ProgramFiles(x86)%\TeamViewer\tv_w32.exe
%ProgramFiles(x86)%\TeamViewer\tv_x64.exe
%ProgramFiles(x86)%\LogMeIn\x64\LogMeIn.exe
%ProgramFiles(x86)%\LogMeIn\x64\LogMeInSystray.exe
%ProgramFiles(x86)%\LogMeIn\x64\LogMeInToolkit.exe
%ProgramFiles(x86)%\LogMeIn\Ignition\LMIIgnition.exe
%ProgramFiles(x86)%\LogMeIn\x86\LogMeIn.exe
%ProgramFiles(x86)%\LogMeIn\x86\LogMeInSystray.exe
%ProgramFiles(x86)%\LogMeIn\x86\LogMeInToolkit.exe
%ProgramFiles%\LogMeIn\x64\LogMeIn.exe
%ProgramFiles%\LogMeIn\x64\LogMeInSystray.exe
%ProgramFiles%\LogMeIn\x64\LogMeInToolkit.exe
%ProgramFiles%\LogMeIn\x86\LogMeIn.exe
%ProgramFiles%\LogMeIn\x86\LogMeInSystray.exe
%ProgramFiles%\LogMeIn\x86\LogMeInToolkit.exe
%ProgramFiles%\LogMeIn\Ignition\LMIIgnition.exe
%ProgramFiles%\TigerVNC\winvnc4.exe
%Temp%\TeamViewer\TeamViewer.exe
%Temp%\TeamViewer\TeamViewer_Desktop.exe
%Temp%\TeamViewer\TeamViewer_Service.exe
%Temp%\TeamViewer\tv_w32.exe
%Temp%\TeamViewer\tv_x64.exe
%systemdrive%\Windows\LTSvc\ltsvc.exe
%systemdrive%\Windows\LTSvc\ltsvcmon.exe
%ProgramFiles(x86)%\ScreenConnect Client (e6b8575bee652c12)\Elsinore.ScreenConnect.ClientService.exe
%ProgramFiles(x86)%\ScreenConnect Client (e6b8575bee652c12)\Elsinore.ScreenConnect.WindowsClient.exe
%ProgramFiles%\ScreenConnect Client (e6b8575bee652c12)\Elsinore.ScreenConnect.ClientService.exe
%ProgramFiles%\ScreenConnect Client (e6b8575bee652c12)\Elsinore.ScreenConnect.WindowsClient.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWAppsSharedConfig\SimpleService.exe
%systemdrive%\Windows\Temp\ShAeroDisabler.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\java.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\javaw.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\JWrapper.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Manage Remote Access Service.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\pack200.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote Access Session.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote Access.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote AccessECompatibility.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote AccessLauncher.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote Support.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote SupportECompatibility.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Remote SupportLauncher.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\ssvagent.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\Stop Remote Access Service.exe
%systemdrive%\ProgramData\JWrapper-Remote Access\JWrapper-Windows64JRE-00000000000-complete\bin\unpack200.exe
%systemdrive%\Documents and Settings\Administrator\Application Data\JWrapper-Remote Support\JWrapper-Windows32JRE-00028603591-complete\bin\Remote Support.exe
%systemdrive%\Documents and Settings\Administrator\Application Data\JWrapper-Remote Support\JWrapperTemp-1428395262-0-app\bin\javaw.exe
%systemdrive%\Documents and Settings\All Users\Application Data\JWrapper-Remote Access\JWAppsSharedConfig\SimpleService.exe
%systemdrive%\Documents and Settings\All Users\Application Data\JWrapper-Remote Access\JWrapper-Windows32JRE-00000000000-complete\bin\Remote Access.exe
%systemdrive%\Documents and Settings\Administrator\Application Data\JWrapper-Remote Support\JWrapper-Windows32JRE-00028603591-complete\bin\javaw.exe</Param2>
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>3</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>42</FunctionId>
    <Param1>%ltsvcdir%\MalwareRemoval\explorer.exe</Param1>
    <Param2>-s -l "C:\Windows\LTSvc\MalwareRemoval\rkill.log" -w C:\Windows\LTSvc\MalwareRemoval\rkill_process_whitelist.txt</Param2>
    <Param3>%consolenumber%</Param3>
    <Param4 />
    <Param5 />
    <Sort>4</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>21</FunctionId>
    <Param1>60</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>5</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>31</FunctionId>
    <Param1>1</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>6</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:CheckIfScanFinished</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>7</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>114</FunctionId>
    <Param1>C:\Windows\LTSvc\MalwareRemoval\rkill.log</Param1>
    <Param2>0</Param2>
    <Param3>:ScanFinished</Param3>
    <Param4 />
    <Param5 />
    <Sort>8</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>21</FunctionId>
    <Param1>30</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>9</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>129</FunctionId>
    <Param1>:CheckIfScanFinished</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>10</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>3</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>139</FunctionId>
    <Param1>:ScanFinished</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>11</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>20</FunctionId>
    <Param1>7</Param1>
    <Param2>C:\Windows\LTSvc\MalwareRemoval\rkill.log</Param2>
    <Param3>rkilllog</Param3>
    <Param4 />
    <Param5 />
    <Sort>12</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>29</FunctionId>
    <Param1>@rkilllog@</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>13</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>172</FunctionId>
    <Param1>Select Email from Users where Name like '@LTRUNBYUSER@'</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>14</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>24</FunctionId>
    <Param1>%sqlresult%</Param1>
    <Param2>RKill Results for %computername% AT %clientname%</Param2>
    <Param3>@rkilllog@</Param3>
    <Param4 />
    <Param5 />
    <Sort>15</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>13</FunctionId>
    <Param1>C:\Windows\LTSvc\MalwareRemoval\rkill.log</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>16</Sort>
    <Continue>1</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>1</Indentation>
  </ScriptSteps>
  <ScriptSteps>
    <Action>2</Action>
    <FunctionId>129</FunctionId>
    <Param1>0</Param1>
    <Param2 />
    <Param3 />
    <Param4 />
    <Param5 />
    <Sort>17</Sort>
    <Continue>0</Continue>
    <OsLimit>0</OsLimit>
    <Indentation>0</Indentation>
  </ScriptSteps>
</ScriptData>
<ScriptVersion>1</ScriptVersion><ScriptGuid>e1d00ad8-ad17-11e2-b867-00155d007008</ScriptGuid><ScriptFlags>0</ScriptFlags><Parameters></Parameters></Table>
    </NewDataSet>
    <File Name="L:\Transfer\Software\MalwareRemoval\explorer.exe" Bytes="This value has been replaced and the file extracted to the Transfer folder" />
    <ScriptFolder>
      <NewDataSet>
        <Table>
          <FolderID>124</FolderID>
          <ParentID>9</ParentID>
          <Name>Misc</Name>
          <GUID>5bb8b5cb-fda9-48f8-a105-986ee2a7426d</GUID>
        </Table>
      </NewDataSet>
    </ScriptFolder>
    <ScriptFolder>
      <NewDataSet>
        <Table>
          <FolderID>9</FolderID>
          <ParentID>0</ParentID>
          <Name>Anti-Spyware</Name>
          <GUID>96dbd2e0-1a86-43ea-9785-8dc7f456aaed</GUID>
        </Table>
      </NewDataSet>
    </ScriptFolder>
  </PackedScript>
</LabTech_Expansion>